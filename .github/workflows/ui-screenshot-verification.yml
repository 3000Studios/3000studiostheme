# Copyright (c) 2025 Mr. jwswain - 3000 Studios. All Rights Reserved.
# UI Screenshot and Visual Testing Automation

name: ðŸ“¸ UI Screenshot & Verification

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:

env:
  THEME_NAME: 3000studios

jobs:
  ui-screenshot:
    name: ðŸ“¸ Capture UI Screenshots
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ”¥ Checkout Repository
        uses: actions/checkout@v4

      - name: ðŸ“Š Generate UI Documentation
        run: |
          echo "# ðŸŽ¨ UI Components Documentation" > ui-docs.md
          echo "" >> ui-docs.md
          echo "**Generated:** $(date)" >> ui-docs.md
          echo "" >> ui-docs.md
          
          echo "## Page Templates" >> ui-docs.md
          echo "" >> ui-docs.md
          
          for page in page-*.php; do
            if [ -f "$page" ]; then
              TEMPLATE_NAME=$(grep "Template Name:" "$page" | sed 's/.*Template Name: *//' | sed 's/ *\*\/.*//')
              echo "### $TEMPLATE_NAME" >> ui-docs.md
              echo "- **File:** \`$page\`" >> ui-docs.md
              echo "" >> ui-docs.md
            fi
          done
          
          echo "## CSS Files" >> ui-docs.md
          echo "" >> ui-docs.md
          find . -name "*.css" -not -path "./node_modules/*" | while read -r css; do
            echo "- \`$css\` ($(wc -l < "$css") lines)" >> ui-docs.md
          done
          
          echo "" >> ui-docs.md
          echo "## JavaScript Files" >> ui-docs.md
          echo "" >> ui-docs.md
          find . -name "*.js" -not -path "./node_modules/*" | while read -r js; do
            echo "- \`$js\` ($(wc -l < "$js") lines)" >> ui-docs.md
          done

      - name: ðŸŽ¨ Check UI Components
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ðŸŽ¨ UI COMPONENTS INVENTORY"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          
          echo ""
          echo "ðŸ“„ Page Templates:"
          find . -name "page-*.php" -exec basename {} \; | sort
          
          echo ""
          echo "ðŸŽ¨ CSS Files:"
          find . -name "*.css" -not -path "./node_modules/*" -exec echo "  âœ“ {}" \;
          
          echo ""
          echo "âš¡ JavaScript Files:"
          find . -name "*.js" -not -path "./node_modules/*" -exec echo "  âœ“ {}" \;
          
          echo ""
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: ðŸ” Check for Visual Elements
        run: |
          echo "Checking for visual design elements..."
          
          # Check for gradient usage
          GRADIENT_COUNT=$(grep -r "gradient" --include="*.css" --include="*.php" . | wc -l || echo "0")
          echo "Gradients found: $GRADIENT_COUNT"
          
          # Check for animations
          ANIMATION_COUNT=$(grep -r "animation\|transition" --include="*.css" --include="*.js" . | wc -l || echo "0")
          echo "Animations/Transitions: $ANIMATION_COUNT"
          
          # Check for neon effects
          NEON_COUNT=$(grep -r "neon\|glow\|shadow" --include="*.css" --include="*.php" . | wc -l || echo "0")
          echo "Neon/Glow effects: $NEON_COUNT"

      - name: ðŸ“¤ Upload UI Documentation
        uses: actions/upload-artifact@v4
        with:
          name: ui-documentation
          path: ui-docs.md
          retention-days: 30

  verify-responsiveness:
    name: ðŸ“± Verify Responsive Design
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ”¥ Checkout Repository
        uses: actions/checkout@v4

      - name: ðŸ“± Check Media Queries
        run: |
          echo "Checking for responsive design implementations..."
          
          CSS_FILES=$(find . -name "*.css" -not -path "./node_modules/*")
          
          for css in $CSS_FILES; do
            MEDIA_COUNT=$(grep -c "@media" "$css" || echo "0")
            if [ "$MEDIA_COUNT" -gt 0 ]; then
              echo "âœ“ $css: $MEDIA_COUNT media queries"
            fi
          done

      - name: ðŸ“Š Generate Responsiveness Report
        run: |
          cat > responsive-report.md << 'EOF'
          # ðŸ“± Responsive Design Report
          
          ## Viewport Breakpoints Expected
          - ðŸ“± Mobile: 320px - 767px
          - ðŸ“± Tablet: 768px - 1023px
          - ðŸ’» Desktop: 1024px+
          
          ## Responsive Elements
          - Grid layouts with auto-fill/auto-fit
          - Flexible typography
          - Adaptive images
          - Touch-friendly buttons
          
          ## Testing Checklist
          - [ ] Mobile portrait (375px)
          - [ ] Mobile landscape (667px)
          - [ ] Tablet (768px)
          - [ ] Desktop (1920px)
          - [ ] 4K (3840px)
          EOF

      - name: ðŸ“¤ Upload Report
        uses: actions/upload-artifact@v4
        with:
          name: responsive-report
          path: responsive-report.md
          retention-days: 7

  check-accessibility:
    name: â™¿ Accessibility Check
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ”¥ Checkout Repository
        uses: actions/checkout@v4

      - name: â™¿ Check Accessibility Features
        run: |
          echo "Checking accessibility features..."
          
          # Check for alt attributes in PHP files
          echo "Checking for image alt attributes..."
          grep -r "img\|<img" --include="*.php" . | grep -v "alt=" && echo "âš ï¸  Missing alt attributes found" || echo "âœ“ Alt attributes present"
          
          # Check for ARIA labels
          echo "Checking for ARIA labels..."
          ARIA_COUNT=$(grep -r "aria-" --include="*.php" --include="*.html" . | wc -l || echo "0")
          echo "ARIA attributes found: $ARIA_COUNT"
          
          # Check for semantic HTML
          echo "Checking semantic HTML usage..."
          grep -r "<nav\|<header\|<footer\|<main\|<section\|<article" --include="*.php" . | wc -l

      - name: ðŸ“Š Generate Accessibility Report
        run: |
          cat > a11y-report.md << 'EOF'
          # â™¿ Accessibility Report
          
          ## WCAG 2.1 AA Compliance Checklist
          
          ### Perceivable
          - [ ] Text alternatives for images
          - [ ] Color contrast ratios meet AA standards
          - [ ] Content not solely conveyed by color
          
          ### Operable
          - [ ] Keyboard accessible
          - [ ] Skip navigation links
          - [ ] Focus indicators visible
          
          ### Understandable
          - [ ] Consistent navigation
          - [ ] Clear labels and instructions
          - [ ] Error identification
          
          ### Robust
          - [ ] Valid HTML/CSS
          - [ ] ARIA landmarks
          - [ ] Semantic HTML elements
          EOF

      - name: ðŸ“¤ Upload Report
        uses: actions/upload-artifact@v4
        with:
          name: accessibility-report
          path: a11y-report.md
          retention-days: 7

  performance-check:
    name: âš¡ Performance Check
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ”¥ Checkout Repository
        uses: actions/checkout@v4

      - name: âš¡ Check Asset Sizes
        run: |
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "âš¡ PERFORMANCE METRICS"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          
          echo ""
          echo "CSS File Sizes:"
          find . -name "*.css" -not -path "./node_modules/*" -exec du -h {} \; | sort -h
          
          echo ""
          echo "JavaScript File Sizes:"
          find . -name "*.js" -not -path "./node_modules/*" -exec du -h {} \; | sort -h
          
          echo ""
          echo "Image Sizes:"
          find . -type f \( -name "*.jpg" -o -name "*.png" -o -name "*.gif" -o -name "*.svg" \) -not -path "./node_modules/*" -exec du -h {} \; | sort -h | tail -10
          
          echo ""
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

      - name: ðŸ“Š Generate Performance Report
        run: |
          cat > performance-report.md << 'EOF'
          # âš¡ Performance Report
          
          ## Performance Optimization Checklist
          
          ### Loading Speed
          - [ ] Minified CSS/JS
          - [ ] Compressed images
          - [ ] Lazy loading enabled
          - [ ] CDN for static assets
          
          ### Caching
          - [ ] Browser caching configured
          - [ ] WordPress object caching
          - [ ] Transient API usage
          
          ### Database
          - [ ] Optimized queries
          - [ ] Indexed tables
          - [ ] Query monitoring
          
          ### Recommendations
          - Target: Page load < 2 seconds
          - First Contentful Paint < 1 second
          - Time to Interactive < 3 seconds
          EOF

      - name: ðŸ“¤ Upload Report
        uses: actions/upload-artifact@v4
        with:
          name: performance-report
          path: performance-report.md
          retention-days: 7

  summary:
    name: ðŸ“Š Generate Complete UI Report
    runs-on: ubuntu-latest
    needs: [ui-screenshot, verify-responsiveness, check-accessibility, performance-check]
    if: always()
    steps:
      - name: ðŸ“Š Final Summary
        run: |
          cat << 'EOF'
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          ðŸŽ¨ UI VERIFICATION COMPLETE
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          
          âœ… UI Documentation Generated
          âœ… Responsive Design Checked
          âœ… Accessibility Reviewed
          âœ… Performance Metrics Collected
          
          All reports available in workflow artifacts.
          
          â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
          EOF
